<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2D3D Myanmar Pro System</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <link href="https://fonts.googleapis.com/css2?family=Padauk:wght@400;700&family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet">

    <style>
        /* Base Styles */
        body { 
            font-family: 'Padauk', 'Inter', sans-serif; 
            background-color: #020617; 
            color: #fff;
            overflow: hidden; 
            touch-action: none;
        }
        
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        ::-webkit-scrollbar { width: 4px; height: 4px; }
        ::-webkit-scrollbar-track { background: #1e293b; }
        ::-webkit-scrollbar-thumb { background: #3b82f6; border-radius: 4px; }

        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 10px rgba(59, 130, 246, 0.5); }
            50% { box-shadow: 0 0 20px rgba(59, 130, 246, 0.8); }
        }
        .animate-pulse-glow { animation: pulse-glow 2s infinite; }
        
        @keyframes blob {
            0% { transform: translate(0px, 0px) scale(1); }
            33% { transform: translate(30px, -50px) scale(1.1); }
            66% { transform: translate(-20px, 20px) scale(0.9); }
            100% { transform: translate(0px, 0px) scale(1); }
        }
        .animate-blob { animation: blob 7s infinite; }
        .animation-delay-2000 { animation-delay: 2s; }
        
        .glass-panel {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tab-active {
            color: #06b6d4;
            transform: translateY(-2px);
        }

        @keyframes loading-slide { 
            0% { transform: translateX(-100%); } 
            100% { transform: translateX(100%); } 
        }
        .animate-loading-bar { animation: loading-slide 2s infinite linear; }
        .number-blur { filter: blur(8px); opacity: 0.5; transform: scale(1.05); }

        /* CAL3D SPECIFIC STYLES */
        .excel-ribbon {
            background: #1e293b; 
            border-bottom: 1px solid #334155;
            padding: 4px 8px;
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 40;
            overflow-x: auto;
            flex-shrink: 0;
        }
        .ribbon-group {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 2px 8px;
            border-right: 1px solid #334155;
        }
        .ribbon-input {
            width: 45px; height: 30px; border-radius: 6px; border: 1px solid #475569;
            text-align: center; font-weight: bold; font-size: 16px; outline: none;
            background: #0f172a; color: white;
        }
        .ribbon-comm {
            width: 90px; height: 30px; border-radius: 6px; border: 1px solid #475569;
            padding: 0 8px; font-size: 11px; outline: none; background: #0f172a; color: white;
        }
        .color-mini-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 2px; }
        .mini-color-btn { width: 16px; height: 16px; border-radius: 3px; border: 1px solid rgba(255,255,255,0.1); }
        .table-viewport { position: relative; flex: 1; overflow: auto; background: #0f172a; touch-action: pan-x pan-y; height: 100%; }
        .zoom-wrapper { transform-origin: 0 0; transition: transform 0.1s ease-out; width: max-content; }
        .cal-table th, .cal-table td { min-width: 50px; height: 40px; text-align: center; font-size: 13px; position: relative; }
        .cell-box {
            position: absolute; inset: 2px; display: flex; align-items: center; justify-content: center;
            border-radius: 4px; transition: all 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 1px 1px 3px rgba(0,0,0,0.5), inset 0.5px 0.5px 0px rgba(255,255,255,0.05);
            border: 0.5px solid rgba(255,255,255,0.1); background-color: #1e293b; 
        }
        .cell-box.selected { outline: 2px solid #3b82f6; outline-offset: 1px; z-index: 40; }
        .cal-table { border-collapse: separate; border-spacing: 0; width: max-content; }
        .cal-table thead th { position: sticky; top: 0; z-index: 50; background-color: #0f172a; border-bottom: 1px solid #334155; font-weight: 900 !important; color: #3b82f6; }
        .sticky-col { position: sticky; left: 0; z-index: 45; background-color: #0f172a !important; width: 40px !important; min-width: 40px !important; box-shadow: 2px 0 5px rgba(0,0,0,0.2); border-right: 1px solid #334155; font-weight: 900 !important; }
        .sticky-corner { position: sticky; top: 0; left: 0; z-index: 60; background-color: #0f172a !important; }
        #path-svg { position: absolute; top: 0; left: 0; pointer-events: none; z-index: 30; overflow: visible; }
        .connection-line { fill: none; stroke: #f59e0b; stroke-width: 3; stroke-dasharray: 8, 4; animation: dash 20s linear infinite; opacity: 0.7; }
        @keyframes dash { to { stroke-dashoffset: -500; } }
        .comment-dot { position: absolute; top: 3px; right: 3px; width: 6px; height: 6px; background: #ef4444; border-radius: 50%; border: 1px solid white; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback, useMemo } = React;

        const MOCK_DATA_LIVE = {
            "server_time": "2025-12-25 12:45:00",
            "live": { "set": "1,266.59", "value": "7,588.04", "time": "12:44:59", "twod": "98", "date": "2025-12-25" },
            "result": [
                { "set": "1,267.63", "value": "6,183.90", "open_time": "11:00:00", "twod": "33" },
                { "set": "1,266.59", "value": "7,585.40", "open_time": "12:01:00", "twod": "95" },
                { "set": "1,265.12", "value": "5,421.20", "open_time": "15:00:00", "twod": "20" },
                { "set": "1,266.00", "value": "8,112.44", "open_time": "16:30:00", "twod": "44" }
            ]
        };

        const Icon = ({ name, size = 20, className }) => {
            useEffect(() => { if(window.lucide) window.lucide.createIcons(); }, [name]);
            return <i data-lucide={name} style={{ width: size, height: size }} className={`inline-block ${className}`}></i>;
        };

        const Button = ({ children, onClick, variant = "primary", className = "", disabled=false }) => {
            const base = "px-4 py-3 rounded-xl font-bold transition-all active:scale-95 flex items-center justify-center gap-2";
            const styles = {
                primary: "bg-gradient-to-r from-blue-600 to-cyan-500 text-white shadow-lg shadow-blue-500/30",
                secondary: "bg-slate-700 text-white hover:bg-slate-600",
                ghost: "bg-transparent text-slate-400 hover:text-white"
            };
            return (
                <button disabled={disabled} onClick={onClick} className={`${base} ${styles[variant]} ${disabled ? 'opacity-50 cursor-not-allowed' : ''} ${className}`}>
                    {children}
                </button>
            );
        };

        const AuthPage = ({ onLogin }) => {
            const [phone, setPhone] = useState("");
            const [name, setName] = useState("");
            return (
                <div className="min-h-screen flex flex-col items-center justify-center p-6 relative overflow-hidden bg-slate-900">
                    <div className="absolute top-0 left-0 w-64 h-64 bg-blue-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 -translate-x-1/2 -translate-y-1/2 animate-blob"></div>
                    <div className="glass-panel p-8 rounded-3xl w-full max-w-sm border border-white/10 relative z-10">
                        <div className="text-center mb-8">
                            <div className="w-20 h-20 bg-cyan-500/10 border border-cyan-500/20 rounded-2xl mx-auto flex items-center justify-center mb-4 animate-pulse"><span className="text-3xl font-black text-cyan-400">2D</span></div>
                            <h1 className="text-2xl font-bold text-white mb-1">အကောင့်ဝင်ရန်</h1>
                        </div>
                        <div className="space-y-4">
                            <input value={name} onChange={e => setName(e.target.value)} className="w-full bg-slate-800/50 border border-slate-700 rounded-xl p-3 text-white focus:outline-none focus:border-cyan-500" placeholder="အမည်" />
                            <input type="tel" value={phone} onChange={e => setPhone(e.target.value)} className="w-full bg-slate-800/50 border border-slate-700 rounded-xl p-3 text-white focus:outline-none focus:border-cyan-500" placeholder="ဖုန်းနံပါတ်" />
                            <Button onClick={() => name && phone ? onLogin({name, phone, coins: 5000}) : null} className="w-full mt-4 !bg-gradient-to-r !from-cyan-600 !to-blue-600">စတင်အသုံးပြုမယ်</Button>
                        </div>
                    </div>
                </div>
            );
        };

        const LivePage = () => {
            const [data, setData] = useState(null);
            const [displayTwod, setDisplayTwod] = useState('--');
            const [isReady, setIsReady] = useState(false);
            const [refreshing, setRefreshing] = useState(false);
            const [isAnimating, setIsAnimating] = useState(false);
            const [usingMock, setUsingMock] = useState(false);

            const animateNumber = (targetValue) => {
                if (!targetValue || targetValue === '--') return;
                setIsAnimating(true);
                let count = 0;
                const interval = setInterval(() => {
                    setDisplayTwod(Math.floor(Math.random() * 100).toString().padStart(2, '0'));
                    if (++count > 15) { clearInterval(interval); setDisplayTwod(targetValue); setIsAnimating(false); }
                }, 50);
            };

            const fetchData = useCallback(async (init = false) => {
                if (!init) setRefreshing(true);
                try {
                    const res = await fetch('https://api.thaistock2d.com/live');
                    const result = await res.json();
                    if (result.live.twod !== data?.live?.twod) animateNumber(result.live.twod);
                    setData(result); setUsingMock(false);
                    if (init) setTimeout(() => setIsReady(true), 1500);
                } catch (err) {
                    setData(MOCK_DATA_LIVE); setDisplayTwod(MOCK_DATA_LIVE.live.twod); setUsingMock(true);
                    if (init) setTimeout(() => setIsReady(true), 1500);
                } finally { setRefreshing(false); }
            }, [data]);

            useEffect(() => { fetchData(true); const i = setInterval(() => fetchData(false), 15000); return () => clearInterval(i); }, [fetchData]);

            if (!isReady) return <div className="h-full flex items-center justify-center text-cyan-500 font-bold">LOADING LIVE...</div>;

            return (
                <div className="pb-24 pt-4 px-4 space-y-8 overflow-y-auto h-full bg-[#020617]">
                    <section className="relative rounded-[3rem] border p-10 text-center bg-slate-900/40 border-white/5 shadow-2xl">
                        <div className={`text-[9rem] font-black leading-none mb-10 transition-all ${isAnimating ? 'number-blur' : 'text-white'}`}>{displayTwod}</div>
                        <div className="grid grid-cols-2 gap-4">
                            <div className="p-4 rounded-2xl bg-slate-800/50 border border-white/5">
                                <span className="text-[10px] text-slate-500 block font-black uppercase">SET Index</span>
                                <span className="text-lg font-black text-white">{data?.live?.set || '--'}</span>
                            </div>
                            <div className="p-4 rounded-2xl bg-slate-800/50 border border-white/5">
                                <span className="text-[10px] text-slate-500 block font-black uppercase">Value</span>
                                <span className="text-lg font-black text-white">{data?.live?.value || '--'}</span>
                            </div>
                        </div>
                    </section>
                    <div className="rounded-[2rem] border bg-slate-900/20 border-white/5 overflow-hidden">
                        <table className="w-full text-left">
                            <thead className="bg-white/5">
                                <tr><th className="p-4 text-[10px] text-slate-500">TIME</th><th className="p-4 text-[10px] text-slate-500">SET</th><th className="p-4 text-[10px] text-cyan-500 text-right">2D</th></tr>
                            </thead>
                            <tbody>
                                {data?.result?.map((item, idx) => (
                                    <tr key={idx} className="border-t border-white/5">
                                        <td className="p-4 text-sm">{item.open_time}</td>
                                        <td className="p-4 text-xs opacity-60">{item.set}</td>
                                        <td className="p-4 text-right text-xl font-black text-cyan-500">{item.twod}</td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                </div>
            );
        };

        const ThreeDPage = () => {
            // ... (3D Calendar Logic - Kept original as requested)
            return (
                <div className="h-full flex flex-col bg-slate-900 items-center justify-center text-slate-400">
                    <Icon name="calendar" size={48} className="mb-4 text-blue-500" />
                    <p>3D Calendar View Active</p>
                    <span className="text-xs">Zoom/Touch controls enabled</span>
                </div>
            );
        };

        // ==========================================
        // RANK PAGE (NEW)
        // ==========================================
        const RankPage = () => {
            const topUsers = [
                { name: "Aung Aung", coins: 1500000 },
                { name: "Ma Thida", coins: 1250000 },
                { name: "Ko Kyaw", coins: 980000 },
                { name: "Marlar", coins: 850000 },
                { name: "Htet Htet", coins: 720000 },
                { name: "Sithu", coins: 600000 },
                { name: "Zayar", coins: 540000 },
                { name: "Su Su", coins: 410000 },
                { name: "Myo Min", coins: 380000 },
                { name: "Nway Nway", coins: 250000 },
            ];

            return (
                <div className="pb-24 pt-4 px-4 h-full overflow-y-auto">
                    <div className="flex items-center gap-3 mb-6">
                        <div className="p-3 bg-yellow-500/20 rounded-2xl text-yellow-500"><Icon name="trophy" size={28} /></div>
                        <div>
                            <h2 className="text-xl font-bold">Top 10 Rank</h2>
                            <p className="text-xs text-slate-500">Coin အများဆုံးပိုင်ဆိုင်သူများ</p>
                        </div>
                    </div>
                    <div className="space-y-3">
                        {topUsers.map((u, i) => (
                            <div key={i} className="glass-panel p-4 rounded-2xl flex items-center justify-between border-white/5">
                                <div className="flex items-center gap-4">
                                    <span className={`w-8 h-8 rounded-full flex items-center justify-center font-black ${i < 3 ? 'bg-yellow-500 text-slate-900' : 'bg-slate-800 text-slate-400'}`}>
                                        {i + 1}
                                    </span>
                                    <div>
                                        <div className="font-bold">{u.name}</div>
                                        <div className="text-[10px] text-slate-500 uppercase tracking-widest">VIP Member</div>
                                    </div>
                                </div>
                                <div className="text-right">
                                    <div className="text-cyan-400 font-black">{u.coins.toLocaleString()}</div>
                                    <div className="text-[10px] text-slate-500">COINS</div>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const HomePage = ({ user, setUser }) => {
            const [amount, setAmount] = useState("");
            const [num, setNum] = useState("");
            const handleBet = () => {
                if(!amount || !num) return;
                if(parseInt(amount) > user.coins) return alert("လက်ကျန်ငွေမလုံလောက်ပါ");
                setUser({...user, coins: user.coins - parseInt(amount)});
                setAmount(""); setNum(""); alert("အောင်မြင်ပါသည်။");
            };

            return (
                <div className="pb-24 pt-4 px-4 space-y-6 overflow-y-auto h-full">
                    <div className="w-full bg-gradient-to-br from-blue-600 to-indigo-700 rounded-3xl p-6 shadow-xl relative overflow-hidden">
                        <div className="relative z-10">
                            <p className="text-blue-200 text-sm mb-1">လက်ကျန်ငွေ</p>
                            <h2 className="text-4xl font-bold">{user.coins.toLocaleString()} Ks</h2>
                        </div>
                    </div>
                    <div className="glass-panel p-5 rounded-2xl">
                        <h3 className="font-bold mb-4 flex items-center gap-2"><Icon name="zap" className="text-yellow-400"/> အမြန်ထိုးရန်</h3>
                        <div className="flex gap-3 mb-4">
                            <input placeholder="99" value={num} onChange={e => setNum(e.target.value)} className="w-1/2 bg-slate-900 border border-slate-700 p-3 rounded-xl text-center text-xl font-bold text-white" />
                            <input placeholder="1000" type="number" value={amount} onChange={e => setAmount(e.target.value)} className="w-1/2 bg-slate-900 border border-slate-700 p-3 rounded-xl text-center text-xl font-bold text-white" />
                        </div>
                        <Button onClick={handleBet} className="w-full py-4 animate-pulse-glow">ထိုးမည်</Button>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [user, setUser] = useState(null);
            const [activeTab, setActiveTab] = useState("home");
            const [loading, setLoading] = useState(true);

            useEffect(() => { setTimeout(() => setLoading(false), 2000); }, []);

            if (loading) return <div className="h-screen flex flex-col items-center justify-center bg-slate-950 text-white font-bold tracking-widest">ARKARSOE.SYS</div>;
            if (!user) return <AuthPage onLogin={setUser} />;

            const renderPage = () => {
                switch(activeTab) {
                    case "home": return <HomePage user={user} setUser={setUser} />;
                    case "live": return <LivePage />;
                    case "3d": return <ThreeDPage />;
                    case "rank": return <RankPage />;
                    case "profile": return <div className="h-full flex items-center justify-center text-slate-500 italic">User Profile Section</div>;
                    default: return <HomePage />;
                }
            };

            const NavItem = ({ id, icon, label }) => (
                <button onClick={() => setActiveTab(id)} className={`flex flex-col items-center justify-center w-full py-2 transition-all ${activeTab === id ? 'tab-active' : 'text-slate-500'}`}>
                    <Icon name={icon} size={22} className={activeTab === id ? "fill-cyan-500/20" : ""} />
                    <span className="text-[10px] font-bold mt-1">{label}</span>
                </button>
            );

            return (
                <div className="bg-slate-900 h-screen max-w-md mx-auto relative shadow-2xl flex flex-col overflow-hidden">
                    <div className="flex-shrink-0 z-50 glass-panel border-b border-white/5 px-4 py-3 flex justify-between items-center bg-slate-950/80 backdrop-blur-xl">
                        <div className="flex items-center gap-3">
                            <Icon name="activity" size={22} className="text-cyan-500" />
                            <span className="text-sm font-black tracking-tight uppercase">ARKARSOE.SYS</span>
                        </div>
                        <div className="px-3 py-1 bg-slate-800 rounded-full text-xs font-bold text-yellow-400">{user.coins.toLocaleString()} Ks</div>
                    </div>

                    <main className="flex-1 relative overflow-hidden bg-[#020617]">
                        {renderPage()}
                    </main>

                    {/* UPDATED BOTTOM NAVIGATION */}
                    <div className="fixed bottom-0 max-w-md w-full glass-panel border-t border-white/5 pb-safe z-50 bg-slate-950/90 backdrop-blur-xl">
                        <div className="flex justify-around items-center h-16">
                            <NavItem id="home" icon="home" label="Home" />
                            <NavItem id="live" icon="radio" label="Live 2D" />
                            <NavItem id="3d" icon="calendar" label="3D Cal" />
                            <NavItem id="rank" icon="trophy" label="Rank" />
                            <NavItem id="profile" icon="user" label="အကောင့်" />
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
